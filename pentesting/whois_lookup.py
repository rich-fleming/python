#!/usr/bin/python3

from ipwhois import IPWhois
import json

# Function to perform WHOIS lookup and extract the network CIDR
def whois_lookup(ip_addresses):
    results = {}
    for ip in ip_addresses:
        try:
            obj = IPWhois(ip)
            whois_result = obj.lookup_rdap(depth=1)
            results[ip] = whois_result
        except Exception as e:
            results[ip] = f"Error: {str(e)}"
    return results

# Replace 'your_ip_list' with your list of IP addresses
your_ip_list = [
    "205.153.84.1"
]

# Perform the WHOIS lookups
lookup_results = whois_lookup(your_ip_list)

# Print the results in a readable format
print(json.dumps(lookup_results, indent=4))
